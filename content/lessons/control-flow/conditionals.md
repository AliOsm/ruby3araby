# الشروط (if/elsif/else/unless)

حتى الآن، كانت برامجنا تُنفذ سطراً بعد سطر من الأعلى للأسفل. لكن البرامج الحقيقية تحتاج لاتخاذ **قرارات**! هنا يأتي دور الجمل الشرطية.

## ما هي الجمل الشرطية؟

الجمل الشرطية تسمح للبرنامج بتنفيذ كود مختلف بناءً على شرط معين. مثل الحياة اليومية:
- **إذا** كان الجو ممطراً، **خذ المظلة**
- **إذا** كان لديك مال كافٍ، **اشترِ الكتاب**، **وإلا** اقترض من صديق

## جملة if البسيطة

أبسط صورة للشرط هي `if`:

```ruby
age = 20

if age >= 18
  puts "أنت بالغ"
end
```

الناتج:
```
أنت بالغ
```

### شرح البنية:

```ruby
if الشرط
  # الكود الذي سيُنفذ إذا كان الشرط صحيحاً
end
```

- `if` تبدأ الجملة الشرطية
- الشرط يُقيّم إلى `true` أو `false`
- الكود بين `if` و `end` يُنفذ فقط إذا كان الشرط `true`
- `end` تُنهي الجملة الشرطية

### مثال: التحقق من كلمة المرور

```ruby
password = "secret123"

if password.length >= 8
  puts "كلمة المرور مقبولة"
end
```

الناتج:
```
كلمة المرور مقبولة
```

### مثال: رقم موجب

```ruby
number = 15

if number > 0
  puts "الرقم موجب"
  puts "قيمته: " + number.to_s
end
```

الناتج:
```
الرقم موجب
قيمته: 15
```

## جملة if-else

ماذا لو أردنا تنفيذ كود بديل عندما يكون الشرط خاطئاً؟ نستخدم `else`:

```ruby
age = 15

if age >= 18
  puts "يمكنك التصويت"
else
  puts "لا يمكنك التصويت بعد"
end
```

الناتج:
```
لا يمكنك التصويت بعد
```

### شرح البنية:

```ruby
if الشرط
  # يُنفذ إذا كان الشرط صحيحاً
else
  # يُنفذ إذا كان الشرط خاطئاً
end
```

### مثال: زوجي أم فردي

```ruby
number = 7

if number % 2 == 0
  puts "الرقم زوجي"
else
  puts "الرقم فردي"
end
```

الناتج:
```
الرقم فردي
```

### مثال: رصيد كافٍ

```ruby
balance = 50
price = 75

if balance >= price
  puts "تم الشراء بنجاح"
  puts "الرصيد المتبقي: " + (balance - price).to_s
else
  puts "رصيدك غير كافٍ"
  puts "تحتاج: " + (price - balance).to_s + " إضافية"
end
```

الناتج:
```
رصيدك غير كافٍ
تحتاج: 25 إضافية
```

## جملة if-elsif-else

عندما يكون لدينا أكثر من احتمالين، نستخدم `elsif`:

```ruby
grade = 85

if grade >= 90
  puts "ممتاز"
elsif grade >= 80
  puts "جيد جداً"
elsif grade >= 70
  puts "جيد"
elsif grade >= 60
  puts "مقبول"
else
  puts "راسب"
end
```

الناتج:
```
جيد جداً
```

### شرح البنية:

```ruby
if الشرط_الأول
  # يُنفذ إذا كان الشرط الأول صحيحاً
elsif الشرط_الثاني
  # يُنفذ إذا كان الشرط الثاني صحيحاً
elsif الشرط_الثالث
  # يُنفذ إذا كان الشرط الثالث صحيحاً
else
  # يُنفذ إذا كانت جميع الشروط خاطئة
end
```

> **ملاحظة:** يُنفذ فقط القسم الأول الذي يكون شرطه صحيحاً، ثم يخرج من الجملة.

### مثال: فئات العمر

```ruby
age = 25

if age < 13
  puts "طفل"
elsif age < 20
  puts "مراهق"
elsif age < 60
  puts "بالغ"
else
  puts "كبير في السن"
end
```

الناتج:
```
بالغ
```

### مثال: حالة الطقس

```ruby
temperature = 35

if temperature < 0
  puts "تجمد! ابقَ في المنزل"
elsif temperature < 15
  puts "بارد - ارتدِ ملابس ثقيلة"
elsif temperature < 25
  puts "معتدل - طقس مثالي"
elsif temperature < 35
  puts "حار - اشرب الماء"
else
  puts "حار جداً! تجنب الشمس"
end
```

الناتج:
```
حار - اشرب الماء
```

## جملة unless (عكس if)

`unless` تعني "إذا لم يكن" - أي عكس `if`:

```ruby
is_raining = false

unless is_raining
  puts "يمكنك الخروج بدون مظلة"
end
```

الناتج:
```
يمكنك الخروج بدون مظلة
```

### المقارنة بين if و unless

```ruby
logged_in = false

# باستخدام if مع النفي
if !logged_in
  puts "الرجاء تسجيل الدخول"
end

# باستخدام unless (أوضح)
unless logged_in
  puts "الرجاء تسجيل الدخول"
end
```

كلاهما يعطي نفس النتيجة، لكن `unless` أوضح عندما نريد "إذا لم يكن".

### unless-else

```ruby
has_permission = false

unless has_permission
  puts "ليس لديك صلاحية"
else
  puts "مرحباً بك"
end
```

الناتج:
```
ليس لديك صلاحية
```

> **تحذير:** لا تستخدم `unless` مع `elsif` - استخدم `if` بدلاً منها لأنها تصبح مربكة.

## الشروط في سطر واحد (Inline Conditionals)

للشروط البسيطة، يمكنك كتابتها في سطر واحد:

### if في سطر واحد

```ruby
age = 20

puts "بالغ" if age >= 18
```

الناتج:
```
بالغ
```

### unless في سطر واحد

```ruby
error = nil

puts "النظام يعمل" unless error
```

الناتج:
```
النظام يعمل
```

### مقارنة الصيغتين

```ruby
score = 95

# الصيغة العادية
if score >= 90
  puts "ممتاز!"
end

# الصيغة المختصرة
puts "ممتاز!" if score >= 90
```

> **نصيحة:** استخدم الصيغة المختصرة فقط للجمل البسيطة القصيرة.

## الشروط المتداخلة (Nested Conditionals)

يمكنك وضع شرط داخل شرط آخر:

```ruby
age = 25
has_license = true

if age >= 18
  if has_license
    puts "يمكنك القيادة"
  else
    puts "تحتاج رخصة قيادة"
  end
else
  puts "أنت صغير جداً للقيادة"
end
```

الناتج:
```
يمكنك القيادة
```

### تبسيط الشروط المتداخلة

غالباً يمكن تبسيط الشروط المتداخلة باستخدام `&&`:

```ruby
age = 25
has_license = true

if age >= 18 && has_license
  puts "يمكنك القيادة"
elsif age >= 18
  puts "تحتاج رخصة قيادة"
else
  puts "أنت صغير جداً للقيادة"
end
```

## الشروط مع العمليات المنطقية

يمكنك دمج عدة شروط باستخدام `&&` و `||`:

```ruby
username = "admin"
password = "secret123"

if username == "admin" && password == "secret123"
  puts "تم تسجيل الدخول بنجاح"
else
  puts "خطأ في اسم المستخدم أو كلمة المرور"
end
```

الناتج:
```
تم تسجيل الدخول بنجاح
```

### مثال: نظام خصومات

```ruby
age = 65
is_member = true

if age < 12 || age >= 65
  puts "خصم 50% (أطفال أو كبار السن)"
elsif is_member
  puts "خصم 20% (أعضاء)"
else
  puts "لا يوجد خصم"
end
```

الناتج:
```
خصم 50% (أطفال أو كبار السن)
```

## جدول ملخص

| الجملة | الاستخدام | مثال |
|--------|----------|-------|
| `if` | تنفيذ كود إذا كان الشرط صحيحاً | `if x > 0` |
| `else` | تنفيذ كود بديل إذا كان الشرط خاطئاً | `else` |
| `elsif` | فحص شرط إضافي | `elsif x == 0` |
| `unless` | تنفيذ كود إذا كان الشرط خاطئاً | `unless error` |
| `if` مختصر | شرط في سطر واحد | `puts "نعم" if ok` |
| `unless` مختصر | شرط عكسي في سطر واحد | `puts "لا" unless ok` |

## أخطاء شائعة

### 1. نسيان end

```ruby
# خطأ!
if age >= 18
  puts "بالغ"
# نسينا end!
```

### 2. استخدام = بدلاً من ==

```ruby
# خطأ! هذا تعيين وليس مقارنة
if age = 18
  puts "18 سنة"
end

# صحيح
if age == 18
  puts "18 سنة"
end
```

### 3. شروط لا تتحقق أبداً

```ruby
# خطأ منطقي! الشرط الثاني لن يتحقق أبداً
if grade >= 60
  puts "ناجح"
elsif grade >= 90  # هذا لن يصل إليه أبداً!
  puts "ممتاز"
end

# صحيح - ضع الشروط الأكثر تحديداً أولاً
if grade >= 90
  puts "ممتاز"
elsif grade >= 60
  puts "ناجح"
end
```

## نصائح مهمة

1. **ضع الشروط الأكثر تحديداً أولاً** في سلسلة elsif
2. **استخدم unless** بدلاً من `if !condition` لوضوح أفضل
3. **تجنب التداخل العميق** - حاول تسطيح الشروط باستخدام && و ||
4. **استخدم الأقواس** لتوضيح الشروط المعقدة
5. **اختبر جميع الحالات** - الصحيحة والخاطئة والحدية

## تمرين: حاسبة التقديرات

حان وقت التطبيق! في محرر الكود على اليسار:

**المطلوب:**
اكتب برنامجاً يحدد تقدير الطالب بناءً على درجته:

1. عرّف متغير `score = 78`
2. استخدم if-elsif-else لتحديد التقدير:
   - 90 فأعلى: اطبع "ممتاز"
   - 80-89: اطبع "جيد جداً"
   - 70-79: اطبع "جيد"
   - 60-69: اطبع "مقبول"
   - أقل من 60: اطبع "راسب"

الناتج المتوقع:
```
جيد
```

> **تلميح:** ابدأ بالشرط الأعلى (90 فأعلى) ثم تنازلياً. تذكر أن `elsif` يُفحص فقط إذا فشلت الشروط السابقة!

---

> **تذكّر:** الجمل الشرطية هي أساس اتخاذ القرارات في البرمجة. كل برنامج تفاعلي يستخدمها!
