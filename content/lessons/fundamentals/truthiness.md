# الصدق والكذب في روبي (Truthiness & Falsiness)

هل تعلم أن روبي تختلف عن معظم لغات البرمجة في تحديد ما هو "صادق" وما هو "كاذب"؟ في هذا الدرس، سنتعلم مفهوماً مهماً جداً يؤثر على كيفية كتابة الشروط.

## ما المقصود بـ Truthiness و Falsiness؟

عندما نستخدم قيمة في شرط (مثل `if`)، روبي تحتاج أن تقرر: هل هذه القيمة تُعتبر **صادقة (truthy)** أم **كاذبة (falsy)**؟

```ruby
value = "مرحبا"

if value
  puts "القيمة صادقة!"
else
  puts "القيمة كاذبة!"
end
```

الناتج:
```
القيمة صادقة!
```

## القاعدة الذهبية في روبي

> **في روبي، فقط `nil` و `false` تُعتبران كاذبتين (falsy). كل شيء آخر صادق (truthy)!**

هذه القاعدة بسيطة جداً وتجعل روبي مختلفة عن لغات مثل JavaScript أو Python.

## القيم الكاذبة (Falsy Values)

في روبي، هناك **فقط قيمتان** كاذبتان:

### 1. القيمة `false`

```ruby
if false
  puts "لن تظهر هذه الرسالة"
else
  puts "false كاذبة"
end
```

الناتج:
```
false كاذبة
```

### 2. القيمة `nil`

```ruby
if nil
  puts "لن تظهر هذه الرسالة"
else
  puts "nil كاذبة"
end
```

الناتج:
```
nil كاذبة
```

## القيم الصادقة (Truthy Values)

**كل شيء آخر** في روبي يُعتبر صادقاً! حتى القيم التي قد تتوقع أنها كاذبة:

### الرقم صفر (0) صادق!

```ruby
if 0
  puts "الصفر صادق في روبي!"
end
```

الناتج:
```
الصفر صادق في روبي!
```

> **مهم:** في لغات مثل JavaScript و C، الرقم 0 يُعتبر كاذباً. لكن في روبي، 0 صادق!

### النص الفارغ ("") صادق!

```ruby
if ""
  puts "النص الفارغ صادق في روبي!"
end
```

الناتج:
```
النص الفارغ صادق في روبي!
```

> **مهم:** في Python و JavaScript، النص الفارغ `""` يُعتبر كاذباً. لكن في روبي، هو صادق!

### المصفوفة الفارغة ([]) صادقة!

```ruby
if []
  puts "المصفوفة الفارغة صادقة في روبي!"
end
```

الناتج:
```
المصفوفة الفارغة صادقة في روبي!
```

### القاموس الفارغ ({}) صادق!

```ruby
if {}
  puts "القاموس الفارغ صادق في روبي!"
end
```

الناتج:
```
القاموس الفارغ صادق في روبي!
```

## جدول مقارنة الصدق والكذب

| القيمة | الصدق/الكذب | ملاحظة |
|--------|-------------|--------|
| `false` | ❌ كاذبة | القيمة المنطقية false |
| `nil` | ❌ كاذبة | غياب القيمة |
| `true` | ✅ صادقة | القيمة المنطقية true |
| `0` | ✅ صادقة | مختلف عن لغات أخرى! |
| `""` | ✅ صادقة | النص الفارغ صادق |
| `" "` | ✅ صادقة | نص يحتوي مسافة |
| `[]` | ✅ صادقة | مصفوفة فارغة |
| `{}` | ✅ صادقة | قاموس فارغ |
| `1` | ✅ صادقة | أي رقم غير صفر |
| `-1` | ✅ صادقة | الأرقام السالبة أيضاً |
| `"hello"` | ✅ صادقة | أي نص |

## التحقق باستخدام !! (Double Bang)

يمكنك استخدام `!!` لتحويل أي قيمة إلى قيمة منطقية حقيقية (`true` أو `false`):

```ruby
puts !!true      # true -> true
puts !!false     # false -> false
puts !!nil       # nil -> false
puts !!0         # 0 -> true
puts !!""        # "" -> true
puts !![]        # [] -> true
puts !!"مرحبا"   # "مرحبا" -> true
```

الناتج:
```
true
false
false
true
true
true
true
```

### كيف يعمل !!؟

- `!` الأول يعكس القيمة (truthy تصبح `false`، falsy تصبح `true`)
- `!` الثاني يعكسها مرة أخرى (للحصول على القيمة المنطقية الصحيحة)

```ruby
value = "نص"
puts !value   # نص صادق، فعكسه false
puts !!value  # false، فعكسه true
```

الناتج:
```
false
true
```

## أمثلة عملية

### التحقق من وجود قيمة

```ruby
name = nil

if name
  puts "مرحباً " + name
else
  puts "لم يتم تحديد الاسم"
end
```

الناتج:
```
لم يتم تحديد الاسم
```

### التحقق من متغير قد يكون nil

```ruby
user_input = nil
default_name = "زائر"

# استخدام || للقيمة الافتراضية
display_name = user_input || default_name
puts "مرحباً " + display_name
```

الناتج:
```
مرحباً زائر
```

### التعامل مع نتائج البحث

```ruby
# تخيل أن هذه نتيجة بحث في قاعدة بيانات
result = nil

if result
  puts "وُجدت النتيجة"
else
  puts "لم يُعثر على نتائج"
end
```

الناتج:
```
لم يُعثر على نتائج
```

## الفرق بين nil و false

رغم أن كلاهما كاذب، إلا أنهما مختلفان:

```ruby
value1 = nil
value2 = false

puts value1 == value2     # هل هما متساويان؟
puts value1.nil?          # هل الأول nil؟
puts value2.nil?          # هل الثاني nil؟
puts value1.class         # نوع الأول
puts value2.class         # نوع الثاني
```

الناتج:
```
false
true
false
NilClass
FalseClass
```

- `nil` يعني "غياب القيمة" أو "لا شيء"
- `false` يعني "لا" أو "خاطئ" بشكل صريح

## التحقق من القيم الفارغة

إذا أردت التحقق من أن نصاً أو مصفوفة فارغة، استخدم `empty?`:

```ruby
text = ""
numbers = []

puts text.empty?      # هل النص فارغ؟
puts numbers.empty?   # هل المصفوفة فارغة؟

# لكن لا يمكن استخدام empty? مع nil
# nil.empty? سيُسبب خطأ!
```

الناتج:
```
true
true
```

### التحقق الآمن باستخدام &.

```ruby
value = nil

# هذا سيُسبب خطأ: value.empty?
# الحل: استخدم &. للتحقق الآمن
puts value&.empty?
```

الناتج:
```

```

(الناتج فارغ لأن `nil&.empty?` يُرجع `nil` والذي يُطبع كسطر فارغ)

## مقارنة روبي مع لغات أخرى

| القيمة | روبي | JavaScript | Python |
|--------|------|------------|--------|
| `0` | ✅ صادق | ❌ كاذب | ❌ كاذب |
| `""` | ✅ صادق | ❌ كاذب | ❌ كاذب |
| `[]` | ✅ صادق | ❌ كاذب* | ❌ كاذب |
| `{}` | ✅ صادق | ❌ كاذب* | ❌ كاذب |
| `nil/null/None` | ❌ كاذب | ❌ كاذب | ❌ كاذب |
| `false/False` | ❌ كاذب | ❌ كاذب | ❌ كاذب |

*في JavaScript، المصفوفات والكائنات الفارغة صادقة، لكن عند المقارنة تتصرف بشكل معقد.

> **تذكّر:** روبي أبسط! فقط `nil` و `false` كاذبتان.

## نصائح مهمة

1. **لا تقارن بـ true أو false صراحةً** عادةً:
   ```ruby
   # ❌ غير مُستحسن
   if value == true
     # ...
   end

   # ✅ أفضل
   if value
     # ...
   end
   ```

2. **استخدم `nil?` للتحقق من nil تحديداً**:
   ```ruby
   if value.nil?
     puts "القيمة هي nil"
   end
   ```

3. **استخدم `empty?` للتحقق من الفراغ**:
   ```ruby
   if text.empty?
     puts "النص فارغ"
   end
   ```

4. **استخدم `||` للقيم الافتراضية**:
   ```ruby
   name = input || "افتراضي"
   ```

## تمرين: التنبؤ بالصدق والكذب

حان وقت التطبيق! في محرر الكود على اليسار:

**المطلوب:**
استخدم `!!` لتحويل القيم التالية إلى قيم منطقية واطبع النتيجة:

1. `false`
2. `nil`
3. `0`
4. `""`
5. `[]`
6. `"روبي"`

الناتج المتوقع:
```
false
false
true
true
true
true
```

> **تلميح:** استخدم `puts !!value` لكل قيمة. تذكر أن فقط `nil` و `false` هما الكاذبتان!

---

> **تذكّر:** قاعدة روبي البسيطة: فقط `nil` و `false` كاذبتان. كل شيء آخر صادق! هذا يجعل كتابة الشروط أسهل وأكثر قابلية للتنبؤ.
