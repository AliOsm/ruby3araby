# المصفوفات (Arrays)

المصفوفات هي واحدة من أهم بنى البيانات في روبي. تُستخدم لتخزين **قائمة مرتبة** من العناصر، ويمكن أن تحتوي على أي نوع من البيانات.

## ما هي المصفوفة؟

المصفوفة هي مجموعة من القيم مُخزنة بترتيب معين. كل عنصر له **فهرس** (index) يبدأ من الصفر.

```ruby
# مصفوفة بسيطة من الأسماء
names = ["أحمد", "سارة", "محمد"]

# المواقع (الفهارس):
#   0       1       2
```

## إنشاء المصفوفات

### الطريقة الأساسية: الأقواس المربعة

```ruby
# مصفوفة فارغة
empty_array = []

# مصفوفة من الأرقام
numbers = [1, 2, 3, 4, 5]

# مصفوفة من النصوص
fruits = ["تفاح", "موز", "برتقال"]

# مصفوفة مختلطة (أنواع متعددة)
mixed = [42, "مرحباً", true, 3.14, nil]

puts numbers
puts "---"
puts fruits
```

الناتج:
```
1
2
3
4
5
---
تفاح
موز
برتقال
```

### طريقة Array.new

```ruby
# مصفوفة بحجم محدد (تمتلئ بـ nil)
arr1 = Array.new(3)
p arr1  # [nil, nil, nil]

# مصفوفة بحجم وقيمة افتراضية
arr2 = Array.new(3, 0)
p arr2  # [0, 0, 0]

# مصفوفة بقيم مُحسوبة
arr3 = Array.new(5) { |i| i * 2 }
p arr3  # [0, 2, 4, 6, 8]
```

### طريقة %w للنصوص

```ruby
# بدون علامات اقتباس لكل عنصر
colors = %w[أحمر أخضر أزرق أصفر]
p colors  # ["أحمر", "أخضر", "أزرق", "أصفر"]

# مفيدة للقوائم الطويلة
days = %w[السبت الأحد الإثنين الثلاثاء الأربعاء الخميس الجمعة]
puts days.length  # 7
```

## الوصول إلى العناصر

### الفهرس الإيجابي (من البداية)

الفهرس يبدأ من **0** وليس 1:

```ruby
fruits = ["تفاح", "موز", "برتقال", "عنب"]

# تفاح (العنصر الأول)
puts fruits[0]
# موز (العنصر الثاني)
puts fruits[1]
# برتقال (العنصر الثالث)
puts fruits[2]
# عنب (العنصر الرابع)
puts fruits[3]
# لا شيء (nil) - خارج النطاق
puts fruits[4]
```

### الفهرس السلبي (من النهاية)

```ruby
fruits = ["تفاح", "موز", "برتقال", "عنب"]

# عنب (الأخير)
puts fruits[-1]
# برتقال (ما قبل الأخير)
puts fruits[-2]
# موز
puts fruits[-3]
# تفاح (الأول)
puts fruits[-4]
```

### جدول الفهارس

| العنصر | الفهرس الإيجابي | الفهرس السلبي |
|--------|-----------------|---------------|
| تفاح | 0 | -4 |
| موز | 1 | -3 |
| برتقال | 2 | -2 |
| عنب | 3 | -1 |

### الوصول باستخدام النطاقات

```ruby
letters = ["أ", "ب", "ت", "ث", "ج"]

# من الفهرس 1 إلى 3 (شامل)
p letters[1..3]   # ["ب", "ت", "ث"]

# من الفهرس 1 إلى 3 (غير شامل)
p letters[1...3]  # ["ب", "ت"]

# آخر 3 عناصر
p letters[-3..-1]  # ["ت", "ث", "ج"]
```

### first و last

```ruby
numbers = [10, 20, 30, 40, 50]

puts numbers.first     # 10 (العنصر الأول)
puts numbers.last      # 50 (العنصر الأخير)
p numbers.first(2)     # [10, 20] (أول عنصرين)
p numbers.last(3)      # [30, 40, 50] (آخر 3 عناصر)
```

## تعديل المصفوفات

### تغيير عنصر موجود

```ruby
colors = ["أحمر", "أخضر", "أزرق"]
# أخضر
puts colors[1]

colors[1] = "أصفر"
# أصفر
puts colors[1]

p colors
```

### إضافة عناصر

#### push - إضافة في النهاية

```ruby
fruits = ["تفاح", "موز"]
p fruits  # ["تفاح", "موز"]

fruits.push("برتقال")
p fruits  # ["تفاح", "موز", "برتقال"]

# يمكن إضافة عدة عناصر
fruits.push("عنب", "مانجو")
p fruits  # ["تفاح", "موز", "برتقال", "عنب", "مانجو"]
```

#### << (المعامل shovel)

طريقة مختصرة للإضافة في النهاية:

```ruby
fruits = ["تفاح", "موز"]

fruits << "برتقال"
fruits << "عنب"

p fruits  # ["تفاح", "موز", "برتقال", "عنب"]

# يمكن تسلسلها
fruits << "مانجو" << "كيوي"
p fruits  # ["تفاح", "موز", "برتقال", "عنب", "مانجو", "كيوي"]
```

#### unshift - إضافة في البداية

```ruby
numbers = [2, 3, 4]
p numbers  # [2, 3, 4]

numbers.unshift(1)
p numbers  # [1, 2, 3, 4]

numbers.unshift(-1, 0)
p numbers  # [-1, 0, 1, 2, 3, 4]
```

#### insert - إضافة في موضع محدد

```ruby
letters = ["أ", "ب", "ج"]

# أضف "ت" في الموضع 2
letters.insert(2, "ت")
p letters  # ["أ", "ب", "ت", "ج"]

# أضف عدة عناصر
letters.insert(1, "X", "Y")
p letters  # ["أ", "X", "Y", "ب", "ت", "ج"]
```

### حذف عناصر

#### pop - حذف من النهاية

```ruby
fruits = ["تفاح", "موز", "برتقال"]
p fruits  # ["تفاح", "موز", "برتقال"]

removed = fruits.pop
# برتقال
puts removed
p fruits      # ["تفاح", "موز"]

# حذف آخر عنصرين
removed_items = fruits.pop(2)
p removed_items  # ["تفاح", "موز"]
p fruits         # []
```

#### shift - حذف من البداية

```ruby
numbers = [1, 2, 3, 4, 5]
p numbers  # [1, 2, 3, 4, 5]

first = numbers.shift
puts first  # 1
p numbers   # [2, 3, 4, 5]

# حذف أول عنصرين
first_two = numbers.shift(2)
p first_two  # [2, 3]
p numbers    # [4, 5]
```

#### delete - حذف قيمة معينة

```ruby
colors = ["أحمر", "أخضر", "أزرق", "أخضر"]

colors.delete("أخضر")
p colors  # ["أحمر", "أزرق"]
# لاحظ: يحذف جميع التكرارات
```

#### delete_at - حذف بالفهرس

```ruby
letters = ["أ", "ب", "ت", "ث"]

letters.delete_at(1)
p letters  # ["أ", "ت", "ث"]
```

## جدول ملخص: إضافة وحذف العناصر

| العملية | الدالة | الموضع | المثال |
|---------|--------|--------|--------|
| إضافة | `push` / `<<` | النهاية | `arr.push(x)` أو `arr << x` |
| إضافة | `unshift` | البداية | `arr.unshift(x)` |
| إضافة | `insert` | موضع محدد | `arr.insert(2, x)` |
| حذف | `pop` | النهاية | `arr.pop` |
| حذف | `shift` | البداية | `arr.shift` |
| حذف | `delete` | قيمة معينة | `arr.delete(x)` |
| حذف | `delete_at` | فهرس محدد | `arr.delete_at(2)` |

## معلومات عن المصفوفة

```ruby
fruits = ["تفاح", "موز", "برتقال"]

# عدد العناصر
puts fruits.length  # 3
puts fruits.size    # 3 (نفس length)
puts fruits.count   # 3 (نفس الشيء)

# هل المصفوفة فارغة؟
puts fruits.empty?  # false

empty_arr = []
puts empty_arr.empty?  # true

# هل تحتوي على عنصر معين؟
puts fruits.include?("موز")     # true
puts fruits.include?("مانجو")   # false

# موضع عنصر
puts fruits.index("موز")      # 1
# لا شيء (nil)
puts fruits.index("مانجو")
```

## التكرار على المصفوفات

### باستخدام for

```ruby
fruits = ["تفاح", "موز", "برتقال"]

for fruit in fruits
  puts "أحب #{fruit}"
end
```

الناتج:
```
أحب تفاح
أحب موز
أحب برتقال
```

### باستخدام each

الطريقة الأكثر استخداماً في روبي:

```ruby
numbers = [1, 2, 3, 4, 5]

numbers.each do |num|
  puts num * 2
end
```

الناتج:
```
2
4
6
8
10
```

### each مع الفهرس

```ruby
names = ["أحمد", "سارة", "محمد"]

names.each_with_index do |name, index|
  puts "#{index + 1}. #{name}"
end
```

الناتج:
```
1. أحمد
2. سارة
3. محمد
```

## أمثلة عملية

### مثال 1: قائمة التسوق

```ruby
# إنشاء قائمة تسوق
shopping_list = ["حليب", "خبز", "بيض"]

puts "قائمة التسوق الأصلية:"
shopping_list.each_with_index do |item, i|
  puts "#{i + 1}. #{item}"
end

# إضافة عناصر جديدة
shopping_list << "جبن"
shopping_list << "زبدة"

puts "\nبعد الإضافة:"
shopping_list.each_with_index do |item, i|
  puts "#{i + 1}. #{item}"
end

# حذف عنصر تم شراؤه
shopping_list.delete("خبز")

puts "\nبعد شراء الخبز:"
shopping_list.each_with_index do |item, i|
  puts "#{i + 1}. #{item}"
end

puts "\nعدد العناصر المتبقية: #{shopping_list.length}"
```

الناتج:
```
قائمة التسوق الأصلية:
1. حليب
2. خبز
3. بيض

بعد الإضافة:
1. حليب
2. خبز
3. بيض
4. جبن
5. زبدة

بعد شراء الخبز:
1. حليب
2. بيض
3. جبن
4. زبدة

عدد العناصر المتبقية: 4
```

### مثال 2: تتبع الدرجات

```ruby
grades = []

# إضافة درجات
grades.push(85)
grades.push(90)
grades.push(78)
grades.push(92)
grades.push(88)

puts "الدرجات: #{grades}"
puts "عدد الدرجات: #{grades.length}"
puts "أعلى درجة: #{grades.max}"
puts "أقل درجة: #{grades.min}"

# حساب المتوسط
sum = 0
grades.each { |g| sum += g }
average = sum / grades.length.to_f

puts "المتوسط: #{average}"
```

الناتج:
```
الدرجات: [85, 90, 78, 92, 88]
عدد الدرجات: 5
أعلى درجة: 92
أقل درجة: 78
المتوسط: 86.6
```

### مثال 3: قائمة مهام

```ruby
# قائمة المهام
tasks = ["كتابة التقرير", "إرسال البريد", "مراجعة الشيفرة"]

# إضافة مهمة في البداية (أولوية عالية)
tasks.unshift("اجتماع عاجل")

# إضافة مهمة في النهاية
tasks.push("ترتيب المكتب")

puts "قائمة المهام:"
tasks.each_with_index do |task, i|
  puts "  [ ] #{task}"
end

# إنجاز أول مهمة
done = tasks.shift
puts "\nتم إنجاز: #{done}"

puts "\nالمهام المتبقية:"
tasks.each_with_index do |task, i|
  puts "  [ ] #{task}"
end
```

الناتج:
```
قائمة المهام:
  [ ] اجتماع عاجل
  [ ] كتابة التقرير
  [ ] إرسال البريد
  [ ] مراجعة الشيفرة
  [ ] ترتيب المكتب

تم إنجاز: اجتماع عاجل

المهام المتبقية:
  [ ] كتابة التقرير
  [ ] إرسال البريد
  [ ] مراجعة الشيفرة
  [ ] ترتيب المكتب
```

## نصائح مهمة

1. **الفهارس تبدأ من 0** - هذا يختلف عن العد البشري الذي يبدأ من 1
2. **استخدم << بدلاً من push** - أقصر وأكثر شيوعاً في روبي
3. **تحقق من الحدود** - `arr[100]` يُرجع `nil` لا خطأ
4. **استخدم each بدلاً من for** - الطريقة المفضلة في روبي
5. **المصفوفات قابلة للتعديل** - يمكن تغييرها بعد الإنشاء

## تمرين: إدارة قائمة التسوق

حان وقت التطبيق! في محرر الشيفرة على اليسار:

**المطلوب:**
1. أنشئ مصفوفة `shopping` تحتوي على: "حليب"، "خبز"، "بيض"
2. أضف "جبن" في النهاية
3. أضف "ماء" في البداية
4. اطبع عدد العناصر
5. اطبع العنصر الأول
6. اطبع العنصر الأخير
7. احذف "خبز" من القائمة
8. اطبع المصفوفة النهائية باستخدام p

**تلميحات:**
- استخدم `<<` للإضافة في النهاية
- استخدم `unshift` للإضافة في البداية
- استخدم `delete` لحذف عنصر معين
- استخدم `p` لطباعة المصفوفة كاملة

الناتج المتوقع:
```
5
ماء
جبن
["ماء", "حليب", "بيض", "جبن"]
```

---

> **تذكّر:** المصفوفات تبدأ فهارسها من 0، وتوفر روبي دوال قوية للتعامل معها!
